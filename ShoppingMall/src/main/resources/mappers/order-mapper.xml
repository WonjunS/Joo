<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwill.joo.repository.OrderRepository">
    <!-- 주문 상세페이지 상품정보-->
    <select id="selectOrderedProduct"
        resultType="com.itwill.joo.dto.OrderedProductDto">   
        select ID, PDETAIL_IMAGE, PNAME, PPRICE, PSTOCK
        from PRODUCTS     
        where ID = #{id}   
    </select>
    
    <!-- 주문 상세페이지 주문자정보-->
    <select id="selectOrdererInfo"
        resultType="com.itwill.joo.dto.OrdererInfoDto">
        select ID, UNAME, UPOSTCODE, USTREET, UDETAIL_ADDRESS, 
               UPHONE, UEMAIL, UCURRENT_POINT
        from USERS
        where ID = #{id}
    </select>
    
    <!-- 주문 내역 조회 페이지 상품, 배송 정보-->
    <select id="selectOrderHistory"
        resultType="com.itwill.joo.dto.OrderHistoryDto">
        select P.PTITLE_IMAGE, P.pname, P.pstock, OP.pprice, O.ocreated_time, D.dstatus, D.dmodified_time
        from PRODUCTS P, ORDERS O, ORDER_PRODUCTS OP, DELIVERIES D
        where O.ID = OP.O_ID
        and OP.P_ID = P.ID
        and D.O_ID = O.ID
        and O.ID = #{id};
    </select>

    
</mapper>